# èª¬æ˜æ¬„

## requirements.txtã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸€è¦§

- ```ajsonrpc==1.2.0```ã€JSON-RPCã‚’ä½¿ã£ãŸãƒªãƒ¢ãƒ¼ãƒˆãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚³ãƒ¼ãƒ«ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®è»½é‡ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```annotated-types==0.7.0```ã€Pythonã®å‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```anyio==4.9.0```ã€éåŒæœŸI/Oã®ãŸã‚ã®çµ±ä¸€APIã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```bottle==0.13.4```ã€è»½é‡ãªWebãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã€ã‚·ãƒ³ãƒ—ãƒ«ã§é«˜é€ŸãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```cachetools==5.5.2```ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‡¦ç†ã‚’æ”¯æ´ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```certifi==2025.6.15```ã€Mozillaã®ãƒ«ãƒ¼ãƒˆè¨¼æ˜æ›¸ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```charset-normalizer==3.4.2```ã€æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ¤œå‡ºã—ã€æ¨™æº–åŒ–ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```click==8.1.7```ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```colorama==0.4.6```ã€ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§è‰²ä»˜ããƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å‡ºåŠ›ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```distro==1.9.0```ã€Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```filelock==3.18.0```ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã™ã‚‹ãƒ­ãƒƒã‚¯ã‚’ç°¡å˜ã«æ‰±ãˆã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```fsspec==2025.5.1```ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æŠ½è±¡åŒ–ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```google-ai-generativelanguage==0.6.15```ã€Googleã®AIæŠ€è¡“ã‚’ä½¿ã£ã¦ã€ç”Ÿæˆçš„ãªè¨€èªãƒ¢ãƒ‡ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```google-api-core==2.25.1```ã€Google Cloud APIã‚’æ‰±ã†ãŸã‚ã®åŸºæœ¬ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```google-api-python-client==2.175.0```ã€Google APIã‚’Pythonã‹ã‚‰æ“ä½œã™ã‚‹ãŸã‚ã®å…¬å¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```google-auth==2.40.3```ã€Google Cloud APIã®èªè¨¼ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```google-auth-httplib2==0.2.0```ã€google-authã¨httplib2ã‚’çµ±åˆã—ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚ã«èªè¨¼æƒ…å ±ã‚’è‡ªå‹•çš„ã«ä»˜åŠ ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```google-generativeai==0.8.5```ã€Googleã®ç”Ÿæˆå‹AIã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```googleapis-common-protos==1.70.0```ã€Google APIã®å…±é€šãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒãƒƒãƒ•ã‚¡å®šç¾©ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```grpcio==1.73.1```ã€Googleã®gRPCãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```grpcio-status==1.71.2```ã€grpcioã¨å…±ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```h11==0.16.0```ã€HTTP/1.1ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®ä½ãƒ¬ãƒ™ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```httpcore==1.0.9```ã€HTTPé€šä¿¡ã®ã‚³ã‚¢æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```httplib2==0.22.0```ã€HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```httpx==0.28.1```ã€é«˜é€Ÿã§ãƒ¢ãƒ€ãƒ³ãªHTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```idna==3.10```ã€IDNã®å‡¦ç†ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```Jinja2==3.1.6```ã€Pythonç”¨ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã€HTMLã‚„XMLãƒ•ã‚¡ã‚¤ãƒ«ã«å‹•çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åŸ‹ã‚è¾¼ã‚€éš›ã«ä½¿ç”¨ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```jiter==0.10.0```ã€JITã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’æ´»ç”¨ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```llvmlite==0.44.0```ã€LLVMã®Pythonãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```MarkupSafe==3.0.2```ã€HTMLã‚„XMLã®ç‰¹æ®Šæ–‡å­—ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```marshmallow==3.26.1```ã€Pythonã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ãŸã‚Šã€ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ãŸã‚Šã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```more-itertools==10.7.0```ã€itertoolsãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ‹¡å¼µãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```mpmath==1.3.0```ã€é«˜ç²¾åº¦ãªæµ®å‹•å°æ•°ç‚¹æ¼”ç®—ã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```networkx==3.5```ã€ã‚°ãƒ©ãƒ•ç†è«–ã‚’æ‰±ã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```numba==0.61.2```ã€Pythonã‚³ãƒ¼ãƒ‰ã‚’JITã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦é«˜é€ŸåŒ–ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```numpy==2.2.6```ã€æ•°å€¤è¨ˆç®—ã‚’è¡Œã†ãŸã‚ã®åŸºæœ¬çš„ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```openai==1.93.0```ã€OpenAIã®APIã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```openai-whisper==20250625```ã€OpenAIã®éŸ³å£°èªè­˜ãƒ¢ãƒ‡ãƒ«ã€ŒWhisperã€ã‚’Pythonã‹ã‚‰ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```packaging==25.0```ã€Pythonã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«é–¢ã™ã‚‹å‡¦ç†ã‚’è¡Œã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```platformio==6.1.18```ã€IoTã‚„çµ„ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ å‘ã‘ã®é–‹ç™ºç’°å¢ƒã‚’æä¾›ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```proto-plus==1.26.1```ã€Protocol Buffersã®Pythonãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```protobuf==5.29.5```ã€Googleã®Protocol Buffersã‚’Pythonã§ä½¿ã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pyasn1==0.6.1```ã€ASN.1å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pyasn1_modules==0.4.2```ã€ASN.1ãƒ‡ãƒ¼ã‚¿ã‚’ã‚ˆã‚Šç°¡å˜ã«æ‰±ã†ãŸã‚ã®è¿½åŠ æ©Ÿèƒ½ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pydantic==2.11.7```ã€ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨è¨­å®šç®¡ç†ã‚’è¡Œã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pydantic_core==2.33.2```ã€pydanticã®ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pyelftools==0.32```ã€ELFãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pyparsing==3.2.3```ã€ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```pyserial==3.5```ã€ã‚·ãƒªã‚¢ãƒ«ãƒãƒ¼ãƒˆã®é€šä¿¡ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```regex==2024.11.6```ã€æ­£è¦è¡¨ç¾ã‚’ä½¿ã£ãŸæ–‡å­—åˆ—æ“ä½œã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```requests==2.32.4```ã€HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç°¡å˜ã«æ‰±ã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```rsa==4.9.1```ã€RSAæš—å·ã®å®Ÿè£…ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```semantic-version==2.10.0```ã€ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°ã‚’æ‰±ã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```sniffio==1.3.1```ã€ç¾åœ¨ä½¿ç”¨ã—ã¦ã„ã‚‹éåŒæœŸI/Oãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```starlette==0.46.2```ã€ASGIå¯¾å¿œã®è»½é‡ãªWebãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€‘
- ```sympy==1.14.0```ã€æ•°å¼è¨ˆç®—ã‚’è¡Œã†ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```tabulate==0.9.0```ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ãƒ†ãƒ¼ãƒ–ãƒ«å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```tiktoken==0.9.0```ã€OpenAIã®ãƒˆãƒ¼ã‚¯ãƒ³åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```torch==2.7.1```ã€æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã€ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚„æ¨è«–ã«ä½¿ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```tqdm==4.67.1```ã€ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```typing-inspection==0.4.1```ã€Type Hintã‚’è§£æã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```typing_extensions==4.14.0```ã€æ–°ã—ã„Pythonã®å‹ãƒ’ãƒ³ãƒˆæ©Ÿèƒ½ã‚’å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```uritemplate==4.2.0```ã€URIãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è§£æãƒ»ç”Ÿæˆã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```urllib3==2.5.0```ã€HTTPé€šä¿¡ã‚’è¡Œã†ãŸã‚ã®ä½ãƒ¬ãƒ™ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘
- ```uvicorn==0.34.3```ã€é«˜æ€§èƒ½ãªASGIã‚µãƒ¼ãƒãƒ¼ã€‘
- ```wsproto==1.2.0```ã€WebSocketãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‘

-----------------------------------------------------------------------

## gemnerate_image.pyã®ä¸€è¦§

### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•
- requirements.txtã‚’å…¥ã‚Œã‚‹
- ãã®å¾Œã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§cdã‚³ãƒãƒ³ãƒ‰ã§generate_image.pyã¨requirements.txtãŒã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•
  ï¼ˆä¾‹ï¼‰cd path\to\your\gemini-env
- ãã®å¾Œã‚³ãƒãƒ³ãƒ‰ã§```pip install -r requirements.txt```ã‚’ã™ã‚‹ã¨ã™ã¹ã¦ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹

### æ“ä½œæ–¹æ³•

- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§```python generate_image.py```ã§èµ·å‹•ã™ã‚‹
- ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä½•ã‚’ç”Ÿæˆã—ã¾ã™ã‹ï¼Ÿã¨å‡ºã‚‹ã®ã§ãã“ã«ç”Ÿæˆã—ãŸã„ã‚‚ã®ã‚’ã„ã†
ï¼ˆä¾‹ï¼‰âœ… ä½•ã‚’ç”Ÿæˆã—ã¾ã™ã‹ï¼Ÿï¼ç™½ã„çŠ¬
- ä¿å­˜å…ˆã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯```--output```ã¾ãŸã¯```-O```ã§ãã‚‹
  ï¼ˆä¾‹ï¼‰```python generate_image.py -o my_creations```
  
### ã‚³ãƒ¼ãƒ‰èª¬æ˜

#### generate_enhanced_prompts
```
def generate_enhanced_prompts(user_prompt: str, gemini_model) -> tuple[str, str]:
    """
    Geminiã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç°¡å˜ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è©³ç´°ãªè‹±èªã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚
    """
    # Geminiã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå¼·åŒ–å‡¦ç†
```
- ```instruction```ã§ã€Geminiãƒ¢ãƒ‡ãƒ«ã«æ¸¡ã™ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å†…å®¹ã‚’æº–å‚™ã—ã€ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã«åŸºã¥ã„ã¦é«˜å“è³ªãªç”»åƒç”Ÿæˆç”¨ã®è©³ç´°ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†Geminiã«æŒ‡ç¤ºã—ã¦ã„ã‚‹
- ```gemini_model.generate_content(instruction)``` ã‚’ä½¿ã£ã¦Geminiãƒ¢ãƒ‡ãƒ«ã«æŒ‡ç¤ºã‚’é€ã‚‹
- Geminiã‹ã‚‰ã®è¿”ç­”ã¯JSONå½¢å¼ã§ã€ã“ã‚Œã‚’è§£æã—ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æŠ½å‡ºã™ã‚‹

#### generate_and_save_image
```
def generate_and_save_image(pipe, prompt: str, negative_prompt: str, save_folder: str):
    """
    ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã®Stable Diffusionãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦ç”»åƒã‚’ç”Ÿæˆã—ã€æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã—ã¾ã™ã€‚
    """
    # Stable Diffusionã§ç”»åƒã‚’ç”Ÿæˆã—ä¿å­˜ã™ã‚‹å‡¦ç†
```
- ```ipe(prompt, negative_prompt=negative_prompt) ```ã®éƒ¨åˆ†ã§ã€Stable Diffusionãƒ¢ãƒ‡ãƒ«ã«ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’æ¸¡ã—ã¦ç”»åƒã‚’ç”Ÿæˆã™ã‚‹
- ```datetime.now().strftime("%Y%m%d_%H%M%S")```ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«åŸºã¥ã„ã¦ç”Ÿæˆã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç”Ÿæˆã•ã‚ŒãŸç”»åƒãŒåå‰ã§ä¿å­˜ã™ã‚‹ã€‚

#### main
```
def main():
    """ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ¡ã‚¤ãƒ³å‡¦ç†"""
    load_dotenv()  # .envãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã‚€
    parser = argparse.ArgumentParser(
        description="Stable Diffusionã‚’ä½¿ã£ã¦å¯¾è©±å½¢å¼ã§ç”»åƒã‚’ç”Ÿæˆã—ã€ä¿å­˜ã—ã¾ã™ã€‚",
        formatter_class=argparse.RawTextHelpFormatter
    )
    # ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã®è¨­å®š
```
- ```load_dotenv() ```ã‚’ä½¿ã£ã¦.envãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰APIã‚­ãƒ¼ã‚„ãã®ä»–ã®è¨­å®šã‚’èª­ã¿è¾¼ã‚€
- ```argparse```ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã‚’è¨­å®šã™ã‚‹
- ```GOOGLE_API_KEY```ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€Gemini APIã‚’åˆæœŸåŒ–ã—ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå¼·åŒ–æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹
- ```StableDiffusionPipeline.from_pretrained()```ã§ã€æŒ‡å®šã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ï¼ˆmodel_idï¼‰ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
------------------------------------------------------------------

## gemini_test.pyã®ä¸€è¦§

#### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•

- ```pip install torch torchvision torchaudio```
- ```pip install diffusers```
- ```pip install transformers```
- ```pip install accelerate```
- ```pip install google-generativeai```
- ```pip install python-dotenv ```
- ```pip install Pillow```

### æ¦‚è¦
- Geminiã‚’ä½¿ã£ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é«˜å“è³ªåŒ–
- Stable Diffusionã§ç”»åƒã‚’ç”Ÿæˆ
- ç”»åƒã‚’æŒ‡å®šãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜
- å¯¾è©±ãƒ«ãƒ¼ãƒ—ã§é€£ç¶šçš„ã«ç”»åƒç”ŸæˆãŒå¯èƒ½

### ã‚³ãƒ¼ãƒ‰èª¬æ˜

#### APIã‚­ãƒ¼ã®è¨­å®š
```
    api_key = os.getenv("GOOGLE_API_KEY")
    if not api_key:
        print("âŒ ã‚¨ãƒ©ãƒ¼: ç’°å¢ƒå¤‰æ•° 'GOOGLE_API_KEY' ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚", file=sys.stderr)
        print("ğŸ’¡ ãƒ’ãƒ³ãƒˆ: .envãƒ•ã‚¡ã‚¤ãƒ«ã« GOOGLE_API_KEY='ã‚ãªãŸã®ã‚­ãƒ¼' ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚", file=sys.stderr)
        sys.exit(1)
```
- ```.env``` ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ ```GOOGLE_API_KEY``` ã‚’å–å¾—ã—ã€ãã‚ŒãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†

#### ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã®é–‹å§‹
```
    try:
        model = genai.GenerativeModel('gemini-1.0-pro')
        # ä¼šè©±å±¥æ­´ã‚’ä¿æŒã™ã‚‹ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹
        chat = model.start_chat(history=[])
```
- ```gemini-1.0-pro```ã¨ã„ã†åå‰ã®Geminiãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€```start_chat()```ã‚’å‘¼ã³å‡ºã—ã¦ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®å¯¾è©±ãƒ«ãƒ¼ãƒ—
```
        print("ğŸ¤– Geminiã¨ã®å¯¾è©±ã‚’é–‹å§‹ã—ã¾ã™ã€‚(çµ‚äº†ã™ã‚‹ã«ã¯ 'quit' ã¾ãŸã¯ 'exit' ã¨å…¥åŠ›ã—ã¦ãã ã•ã„)")

        while True:
            prompt = input("You: ")

            if prompt.lower() in ["quit", "exit"]:
                print("\nğŸ‘‹ å¯¾è©±ã‚’çµ‚äº†ã—ã¾ã™ã€‚")
                break
```
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å¯¾è©±ã‚’ç¶šã‘ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ—ãŒå§‹ã¾ã‚Šã€```quit```ã¾ãŸã¯```exit```ã¨å…¥åŠ›ã™ã‚‹ã“ã¨ã§ã€å¯¾è©±ã‚’çµ‚äº†ã§ãã‚‹

#### Gemini APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¡¨ç¤º
```
            print("Gemini: ", end="", flush=True)
            response = chat.send_message(prompt, stream=True)
            for chunk in response:
                print(chunk.text, end="", flush=True)
            print() # æ”¹è¡Œ
```
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã‚’```chat.send_message()```ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ã¦Gemini APIã«é€ä¿¡ã—ã€ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å—ã‘å–ã‚‹

  -------------------------------------------------------------------------

## gemini_Whissperã®ä¸€è¦§

### ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ```pip install -U openai-whisper```
- ```pip install moviepy```
- [ffmpeg](https://ffmpeg.org/download.html)ã‚’å…¥ã‚Œã‚‹</br>
  ãƒ»å…¥ã‚ŒãŸå¾Œ```ffmpeg -version```ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ç¢ºèªã—ã¦å‡ºã¦ã‚Œã°ã‚ˆã„

### æ¦‚è¦
- Whisperã‚’ä½¿ã£ã¦å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚„éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ—¥æœ¬èªã®æ–‡å­—ãŠã“ã—ã™ã‚‹ãŸã‚
- **AudioTranscripts**ã«å‹•ç”»ã§éŸ³ã¨ã—ã¦ã§ã¦ãŸå†…å®¹ã‚’æ–‡å­—ã¨ã—ã¦ä¿å­˜ã™ã‚‹
- ä¿å­˜å…ˆã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯```--output```ã¾ãŸã¯```-O```ã§ãã‚‹
- mp4ãƒ•ã‚©ãƒ«ãƒ€ã«å‹•ç”»ã‚ã‚Œã°ãƒ•ã‚¡ã‚¤ãƒ«åã®æŒ‡å®šã ã‘ã§ã§ãã‚‹

### ã‚³ãƒ¼ãƒ‰èª¬æ˜

#### moviepyã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
```
try:
    from moviepy import VideoFileClip
except ImportError:
    print("âŒ ã‚¨ãƒ©ãƒ¼: 'moviepy'ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚", file=sys.stderr)
    print("ğŸ’¡ ãƒ’ãƒ³ãƒˆ: 'pip install moviepy' ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚", file=sys.stderr)
    sys.exit(1)
```
- ```moviepy```ã¯å‹•ç”»å‡¦ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§éŸ³å£°ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«
- ```try-except```ã¯moviepyãŒã‚¤ãƒ³ãƒãƒ¼ãƒˆã§ããªã‹ã£ãŸã‚‰ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã™ã‚‹ã€‚

#### Whisperãƒ¢ãƒ‡ãƒ«ã®ãƒ­ãƒ¼ãƒ‰ã¨æ–‡å­—èµ·ã“ã—

```
print(f"ğŸ”„ ãƒ¢ãƒ‡ãƒ« '{model_name}' ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™...")
model = whisper.load_model(model_name)
print(f"ğŸ¤ '{os.path.basename(media_path)}' ã®æ–‡å­—èµ·ã“ã—ã‚’é–‹å§‹ã—ã¾ã™... (ã“ã‚Œã«ã¯æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™)")
result = model.transcribe(audio_path_to_transcribe, language="ja", fp16=False)
```
- Whisperãƒ¢ãƒ‡ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’```language="ja"```ã¯æ—¥æœ¬èªã§æ–‡å­—èµ·ã“ã—ã‚’è¡Œã†
- ```fp16=False```ã¯ã€CPUã§å®Ÿè¡Œã™ã‚‹éš›ã«ç²¾åº¦ã‚’å®‰å®šã•ã›ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³

#### mainé–¢æ•°ã®å‡¦ç†

```
if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Whisperã§éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚„å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—ã—ã¾ã™ã€‚")
    parser.add_argument("media_file", help="æ–‡å­—èµ·ã“ã—ã™ã‚‹éŸ³å£°ã¾ãŸã¯å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã€‚ãƒ•ã‚¡ã‚¤ãƒ«åã®ã¿æŒ‡å®šã—ãŸå ´åˆã€'mp4'ãƒ•ã‚©ãƒ«ãƒ€å†…ã‚’æ¤œç´¢ã—ã¾ã™ã€‚ (ä¾‹: 'my_video.mp4' ã¾ãŸã¯ 'C:\\videos\\my_video.mp4')")
    parser.add_argument("-m", "--model", default="base", choices=["tiny", "base", "small", "medium", "large"], help="ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«")
    parser.add_argument("-o", "--output", help="æ–‡å­—èµ·ã“ã—çµæœã‚’ä¿å­˜ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã€‚æŒ‡å®šã—ãªã„å ´åˆã€'AudioTranscripts'ãƒ•ã‚©ãƒ«ãƒ€ã«è‡ªå‹•ã§ä¿å­˜ã•ã‚Œã¾ã™ã€‚")

    args = parser.parse_args()
```
- ```argparse.ArgumentParser```ã‚’ä½¿ã£ã¦ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã‚’è¨­å®š
- ```media_file```ã¯æ–‡å­—èµ·ã“ã—å¯¾è±¡ã®éŸ³å£°ã¾ãŸã¯å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã™ã‚‹
- ```-m```/```--model```ã¯ä½¿ç”¨ã™ã‚‹Whisperã®ãƒ¢ãƒ‡ãƒ«
- ```-o```/```--output```ã¯æ–‡å­—èµ·ã“ã—çµæœã‚’ä¿å­˜ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹

#### å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã¨å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’è§£æ±º
```
input_media_path = args.media_file
if not os.path.isabs(input_media_path) and os.path.basename(input_media_path) == input_media_path:
    potential_path = os.path.join(script_dir, "mp4", input_media_path)
    if os.path.exists(potential_path):
        input_media_path = potential_path
        print(f"â„¹ï¸ 'mp4'ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ« '{os.path.basename(input_media_path)}' ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚")
```
- å…¥åŠ›ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒç›¸å¯¾ãƒ‘ã‚¹ã§ã‚ã£ãŸå ´åˆã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®```mp4```ãƒ•ã‚©ãƒ«ãƒ€å†…ã‚’æ¤œç´¢ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹
```
output_path = args.output
if output_path is None:
    save_folder = os.path.join(script_dir, "AudioTranscripts")
    os.makedirs(save_folder, exist_ok=True)
    base_filename = os.path.basename(input_media_path)
    filename_without_ext = os.path.splitext(base_filename)[0]
    output_filename = f"{filename_without_ext}.txt"
    output_path = os.path.join(save_folder, output_filename)
```
- å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€```AudioTranscripts```ãƒ•ã‚©ãƒ«ãƒ€ã«è‡ªå‹•ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ã€‚
#### ãƒ¡ã‚¤ãƒ³å‡¦ç†ã®å®Ÿè¡Œ
```
transcribe_media(input_media_path, args.model, output_path)
```
- ```transcribe_media```é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã€å®Ÿéš›ã®æ–‡å­—èµ·ã“ã—ã‚’è¡Œã†
